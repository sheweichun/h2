webpackJsonp([20],{249:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){for(var t=e.split("\n"),n=[],o=0;o<t.length;o++){var r=t[o],a=r.split(/\s+/);if(4!==a.length)return f.Message.error("积分信息格式不正确, 少于四列"),[];n.push({realName:a[0],phone:a[1],type:7,addBonus:a[2],typeName:a[3]})}return n}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(2),c=o(i),f=(n(9),n(3)),h=n(0),d=o(h),p=n(8),g=o(p),b=n(7),m=f.DatePicker.RangePicker,y=function(e){function t(e){r(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={range:[(0,d.default)().subtract(7,"days"),(0,d.default)()],batchBonus:"",batchBonusList:[],batchErrMsg:""},n.onChangeTime=n.onChangeTime.bind(n),n.onExportBonus=n.onExportBonus.bind(n),n.onBatchAddBonus=n.onBatchAddBonus.bind(n),n}return u(t,e),l(t,[{key:"onChangeTime",value:function(e){console.log("val :",e),this.setState({range:e})}},{key:"onExportBonus",value:function(){var e=this.state.range;if(!e||2!==e.length||!e[0]||!e[1])return f.Message.warning("请选择日期");var t=e[0].format("YYYY-MM-DD HH:mm:ss"),n=e[1].format("YYYY-MM-DD HH:mm:ss");console.log("go here!!"),window.open(g.default.exportAllBonusInfo.param.url+"?query=a.create_time >= '"+t+"' and a.create_time <= '"+n+"'")}},{key:"onBatchAddBonus",value:function(){var e=this;f.Message.show({type:"loading",content:"批量添加中...",duration:0}),this.setState({batchErrMsg:""}),(0,b.Fetch)("batchAddBonus",{records:JSON.stringify(this.state.batchBonusList)}).then(function(t){f.Message.success("批量添加成功"),e.setState({batchBonus:"",batchBonusList:[]})},function(t){console.error(t),f.Message.error("批量添加失败 :"+t.statusText),e.setState({batchErrMsg:t.statusText})})}},{key:"render",value:function(){var e=this,t=this.state,n=t.range,o=t.batchBonus,r=t.batchBonusList,a=t.batchErrMsg;return c.default.createElement("div",null,"export",c.default.createElement(m,{showTime:!0,value:n,onChange:this.onChangeTime}),c.default.createElement(f.Button,{type:"primary",onClick:this.onExportBonus},"导出积分信息"),c.default.createElement("div",null,c.default.createElement("div",null,"批量添加积分，请填入信息【请慎用】"),c.default.createElement(f.Input.TextArea,{placeholder:"请输入积分信息",value:o,onChange:function(t){e.setState({batchBonus:t,batchBonusList:s(t)})}}),c.default.createElement("div",null,"记录数： ",r.length),c.default.createElement("pre",{style:{height:"400px",overflow:"auto"}},JSON.stringify(r,null,"\t")),c.default.createElement("div",null,c.default.createElement("div",null,"错误信息："),c.default.createElement("pre",{style:{color:"red",height:"100px",overflow:"auto"}},a)),c.default.createElement(f.Button,{type:"primary",onClick:this.onBatchAddBonus},"批量添加")))}}]),t}(i.Component);t.default=y}});
//# sourceMappingURL=exportData.js.map